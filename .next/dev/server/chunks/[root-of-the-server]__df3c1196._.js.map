{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///home/ayan/Programming/NextFasterPostgres/src/app/api/prefetch-images/%5B...rest%5D/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\nimport { parseHTML } from \"linkedom\";\n\nexport const dynamic = \"force-static\";\n\nfunction getHostname() {\n  if (process.env.NODE_ENV === \"development\") {\n    return \"localhost:3000\";\n  }\n  if (process.env.VERCEL_ENV === \"production\") {\n    return process.env.VERCEL_PROJECT_PRODUCTION_URL;\n  }\n  return process.env.VERCEL_BRANCH_URL;\n}\n\nexport async function GET(\n  _: NextRequest,\n  { params }: { params: { rest: string[] } },\n) {\n  const schema = process.env.NODE_ENV === \"development\" ? \"http\" : \"https\";\n  const host = getHostname();\n  if (!host) {\n    return new Response(\"Failed to get hostname from env\", { status: 500 });\n  }\n  const href = (await params).rest.join(\"/\");\n  if (!href) {\n    return new Response(\"Missing url parameter\", { status: 400 });\n  }\n  const url = `${schema}://${host}/${href}`;\n  const response = await fetch(url);\n  if (!response.ok) {\n    return new Response(\"Failed to fetch\", { status: response.status });\n  }\n  const body = await response.text();\n  const { document } = parseHTML(body);\n  const images = Array.from(document.querySelectorAll(\"main img\"))\n    .map((img) => ({\n      srcset: img.getAttribute(\"srcset\") || img.getAttribute(\"srcSet\"), // Linkedom is case-sensitive\n      sizes: img.getAttribute(\"sizes\"),\n      src: img.getAttribute(\"src\"),\n      alt: img.getAttribute(\"alt\"),\n      loading: img.getAttribute(\"loading\"),\n    }))\n    .filter((img) => img.src);\n  return NextResponse.json(\n    { images },\n    {\n      headers: {\n        \"Cache-Control\": \"public, max-age=3600\",\n      },\n    },\n  );\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEO,MAAM,UAAU;AAEvB,SAAS;IACP,wCAA4C;QAC1C,OAAO;IACT;;;AAKF;AAEO,eAAe,IACpB,CAAc,EACd,EAAE,MAAM,EAAkC;IAE1C,MAAM,SAAS,uCAAyC,SAAS;IACjE,MAAM,OAAO;IACb,IAAI,CAAC,MAAM;QACT,OAAO,IAAI,SAAS,mCAAmC;YAAE,QAAQ;QAAI;IACvE;IACA,MAAM,OAAO,CAAC,MAAM,MAAM,EAAE,IAAI,CAAC,IAAI,CAAC;IACtC,IAAI,CAAC,MAAM;QACT,OAAO,IAAI,SAAS,yBAAyB;YAAE,QAAQ;QAAI;IAC7D;IACA,MAAM,MAAM,GAAG,OAAO,GAAG,EAAE,KAAK,CAAC,EAAE,MAAM;IACzC,MAAM,WAAW,MAAM,MAAM;IAC7B,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,OAAO,IAAI,SAAS,mBAAmB;YAAE,QAAQ,SAAS,MAAM;QAAC;IACnE;IACA,MAAM,OAAO,MAAM,SAAS,IAAI;IAChC,MAAM,EAAE,QAAQ,EAAE,GAAG,IAAA,uKAAS,EAAC;IAC/B,MAAM,SAAS,MAAM,IAAI,CAAC,SAAS,gBAAgB,CAAC,aACjD,GAAG,CAAC,CAAC,MAAQ,CAAC;YACb,QAAQ,IAAI,YAAY,CAAC,aAAa,IAAI,YAAY,CAAC;YACvD,OAAO,IAAI,YAAY,CAAC;YACxB,KAAK,IAAI,YAAY,CAAC;YACtB,KAAK,IAAI,YAAY,CAAC;YACtB,SAAS,IAAI,YAAY,CAAC;QAC5B,CAAC,GACA,MAAM,CAAC,CAAC,MAAQ,IAAI,GAAG;IAC1B,OAAO,gJAAY,CAAC,IAAI,CACtB;QAAE;IAAO,GACT;QACE,SAAS;YACP,iBAAiB;QACnB;IACF;AAEJ"}}]
}